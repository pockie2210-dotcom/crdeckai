<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Scan Test</title>
    <style>
        body {
            font-family: Arial;
            background: #1a1a1a;
            color: white;
            padding: 20px;
        }

        input {
            padding: 10px;
            font-size: 16px;
            width: 200px;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }

        #result {
            margin-top: 20px;
            padding: 20px;
            background: #2a2a2a;
            border-radius: 8px;
        }
    </style>
</head>

<body>
    <h1>Player Scan Test</h1>
    <input id="tagInput" placeholder="#PLAYERTAG" value="G9YV9GR8R">
    <button onclick="testScan()">Scan Player</button>
    <div id="result">Result will appear here...</div>

    <script>
        const API_BASE_URL = 'http://localhost:3000';

        async function testScan() {
            const tagInput = document.getElementById('tagInput');
            const result = document.getElementById('result');

            const rawTag = tagInput.value.trim();
            if (!rawTag) {
                result.innerHTML = '‚ùå Please enter a player tag!';
                return;
            }

            const tag = rawTag.startsWith('#') ? rawTag : '#' + rawTag;
            const encodedTag = encodeURIComponent(tag);

            result.innerHTML = 'üîÑ Loading...';

            try {
                console.log('Fetching:', `${API_BASE_URL}/player/${encodedTag}`);

                const response = await fetch(`${API_BASE_URL}/player/${encodedTag}`, {
                    method: 'GET',
                    headers: { 'Accept': 'application/json' }
                });

                console.log('Response status:', response.status);

                if (!response.ok) {
                    const errText = await response.text();
                    throw new Error(`HTTP ${response.status}: ${errText}`);
                }

                const data = await response.json();
                console.log('Data received:', data);

                result.innerHTML = `
                    <h2>‚úÖ Success!</h2>
                    <p><strong>Name:</strong> ${data.name}</p>
                    <p><strong>Tag:</strong> ${data.tag}</p>
                    <p><strong>Trophies:</strong> ${data.trophies}</p>
                    <p><strong>Level:</strong> ${data.expLevel}</p>
                    <p><strong>Wins:</strong> ${data.wins}</p>
                    <p><strong>Deck:</strong> ${data.currentDeck?.length || 0} cards</p>
                `;

            } catch (err) {
                console.error('Error:', err);
                result.innerHTML = `‚ùå <strong>Error:</strong> ${err.message}`;
            }
        }

        console.log('Test page loaded successfully');
    </script>
</body>

</html>